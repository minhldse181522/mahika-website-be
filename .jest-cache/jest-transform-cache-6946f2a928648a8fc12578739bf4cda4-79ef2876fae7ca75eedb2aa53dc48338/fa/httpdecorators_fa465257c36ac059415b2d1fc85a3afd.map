{"file":"D:\\FPT\\SUMMER_2025\\EXE201\\mahika-website-backend\\src\\decorators\\http.decorators.ts","mappings":"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","names":[],"sources":["D:\\FPT\\SUMMER_2025\\EXE201\\mahika-website-backend\\src\\decorators\\http.decorators.ts"],"sourcesContent":["import { ErrorDto } from '@/common/dto/error.dto';\nimport {\n  HttpCode,\n  HttpStatus,\n  type Type,\n  applyDecorators,\n} from '@nestjs/common';\nimport {\n  ApiBasicAuth,\n  ApiBearerAuth,\n  ApiCreatedResponse,\n  ApiOkResponse,\n  ApiOperation,\n  ApiResponse,\n  ApiSecurity,\n} from '@nestjs/swagger';\nimport { STATUS_CODES } from 'http';\nimport { Public } from './public.decorator';\nimport { ApiPaginatedResponse } from './swagger.decorators';\n\ntype ApiResponseType = number;\ntype ApiAuthType = 'basic' | 'api-key' | 'jwt';\ntype PaginationType = 'offset' | 'cursor';\n\ninterface IApiOptions<T extends Type<any>> {\n  type?: T;\n  summary?: string;\n  description?: string;\n  errorResponses?: ApiResponseType[];\n  statusCode?: HttpStatus;\n  isPaginated?: boolean;\n  paginationType?: PaginationType;\n}\n\ntype IApiPublicOptions = IApiOptions<Type<any>>;\n\ninterface IApiAuthOptions extends IApiOptions<Type<any>> {\n  auths?: ApiAuthType[];\n}\n\nexport const ApiPublic = (options: IApiPublicOptions = {}): MethodDecorator => {\n  const defaultStatusCode = HttpStatus.OK;\n  const defaultErrorResponses = [\n    HttpStatus.BAD_REQUEST,\n    HttpStatus.FORBIDDEN,\n    HttpStatus.NOT_FOUND,\n    HttpStatus.UNPROCESSABLE_ENTITY,\n    HttpStatus.INTERNAL_SERVER_ERROR,\n  ];\n  const isPaginated = options.isPaginated || false;\n  const ok = {\n    type: options.type,\n    description: options?.description ?? 'OK',\n    paginationType: options.paginationType || 'offset',\n  };\n\n  const errorResponses = (options.errorResponses || defaultErrorResponses)?.map(\n    (statusCode) =>\n      ApiResponse({\n        status: statusCode,\n        type: ErrorDto,\n        description: STATUS_CODES[statusCode],\n      }),\n  );\n\n  return applyDecorators(\n    Public(),\n    ApiOperation({ summary: options?.summary }),\n    HttpCode(options.statusCode || defaultStatusCode),\n    isPaginated ? ApiPaginatedResponse(ok) : ApiOkResponse(ok),\n    ...errorResponses,\n  );\n};\n\nexport const ApiAuth = (options: IApiAuthOptions = {}): MethodDecorator => {\n  const defaultStatusCode = HttpStatus.OK;\n  const defaultErrorResponses = [\n    HttpStatus.BAD_REQUEST,\n    HttpStatus.UNAUTHORIZED,\n    HttpStatus.FORBIDDEN,\n    HttpStatus.NOT_FOUND,\n    HttpStatus.UNPROCESSABLE_ENTITY,\n    HttpStatus.INTERNAL_SERVER_ERROR,\n  ];\n  const isPaginated = options.isPaginated || false;\n  const ok = {\n    type: options.type,\n    description: options?.description ?? 'OK',\n    paginationType: options.paginationType || 'offset',\n  };\n  const auths = options.auths || ['jwt'];\n\n  const errorResponses = (options.errorResponses || defaultErrorResponses)?.map(\n    (statusCode) =>\n      ApiResponse({\n        status: statusCode,\n        type: ErrorDto,\n        description: STATUS_CODES[statusCode],\n      }),\n  );\n\n  const authDecorators = auths.map((auth) => {\n    switch (auth) {\n      case 'basic':\n        return ApiBasicAuth();\n      case 'api-key':\n        return ApiSecurity('Api-Key');\n      case 'jwt':\n        return ApiBearerAuth();\n    }\n  });\n\n  return applyDecorators(\n    ApiOperation({ summary: options?.summary }),\n    HttpCode(options.statusCode || defaultStatusCode),\n    isPaginated\n      ? ApiPaginatedResponse(ok)\n      : options.statusCode === 201\n        ? ApiCreatedResponse(ok)\n        : ApiOkResponse(ok),\n    ...authDecorators,\n    ...errorResponses,\n  );\n};\n"],"version":3}